---
title: Web 安全
date: 2019-06-10 
tags:
    - 日记
    - 学习Vlog
---
一些学习笔记。
<!-- more -->
基于客户端的脚本安全
****************************************************************************
### XSS
什么是XSS？
XSS是一种跨站脚本攻击。

怎样发起XSS攻击？
通过HTML注入篡改网页，插入恶意脚本，从而在用户浏览网页时，控制用户浏览器的一种攻击。
反射型XSS:
构造特殊的URL里面包含恶意代码，诱使用户触发（“点击”）一个恶意链接，攻击成功。效果来讲“非持久型XSS”
存储型XSS:
恶意脚本存储在数据库（服务器端），所有访问服务器的用户都会在他们的浏览器中执行这段恶意的JavaScript代码。效果来讲存在时间较久
DOM Based XSS:
效果来说与反射型差不多，修改页面的DOM节点形成的XSS

XSS攻击手段：
+ cookie 劫持
+ 构造GET 与 POST 请求
+ 钓鱼网站
+ 识别用户的浏览器
+ 识别用户安装的软件
+ 通过CSS发现用户曾经访问过的网站
+ 获取用户的真实IP地址

XSS的防御：
+ 对cookie设置HttpOnly属性
+ 对用户输入和富文本及变量输出进行编码和转义

如何测试XSS漏洞：
应用XSS攻击平台渗透测试使用（Attack API、BeEF、XSS-Proxy）

### CSRF
什么是CSRF？
CSRF是跨站点请求伪造

CSRF怎么发起攻击？
诱使用户在第三方站点执行了攻击者伪造的带参数的请求。
请求被验证通过是因为某些浏览器策略允许发送第三方cookie，或是利用P3P头的介入。
CSRF攻击不仅限于GET请求，还可以把参数构建一个POST表单提交。

CSRF的防御：
+ 验证码
+ Anti CSRF Token（前提是token的值是随机的）

如何测试CSRF漏洞：
+ 抓到数据包是否带有token验证，或者还有一个固定的变量可以被控制，就会存在CSRF。
+ 构造一个没有token，referer为空请求的post请求，成功就存在CSRF

### 点击劫持
什么是ClickJacking？
点击劫持是一种视觉欺骗手段

怎么发起ClickJacking？
使用一个透明的、不可见的iframe,覆盖在讴歌网页上，然后诱使用户在该网页上进行操作，通过调整iframe页面位置，点击触发一些功能性按钮。
浏览器的拖拽操作不受同源策略限制，运用拖拽劫持可以达到数据窃取

ClickJacking的防御：
使用 X-Frame-Options HTTP 响应头。
X-Frame-Options 有三个值:
DENY - 表示该页面不允许在 frame 中展示，即便是在相同域名的页面中嵌套也不允许。
SAMEORIGIN - 表示该页面可以在相同域名页面的 frame 中展示。
ALLOW-FROM - 表示该页面可以在指定来源的 frame 中展示。

如何测试ClickJacking漏洞：
是否可以进行iframe嵌套

基于服务器的脚本安全
****************************************************************************
### 注入攻击
本质是用户输入的数据当做代码执行。
关键条件是用户能够控制输入；原本程序要执行的代码，拼接了用户输入的数据

常见的注入攻击：
SQL注入、XML注入、代码注入、CRLF注入

如何防御SQL注入：
+ 使用预编译语句，绑定变量
+ 使用安全的存储过程
+ 检查数据类型

如何测试SQL注入漏洞：
在URL中“盲注”SQL语句,判断哪些参数存在SQL注入漏洞

****************************************************************************
实际场景中攻击手段都不是单一的，往往都是同时嵌套使用